"use strict";(self.webpackChunkreact_admin_kit=self.webpackChunkreact_admin_kit||[]).push([[634],{15634:function(dr,mn,v){v.d(mn,{$f:function(){return kt},t4:function(){return Jt},zx:function(){return rn},mL:function(){return or},Qj:function(){return ge},Yr:function(){return en},A9:function(){return Un},QV:function(){return Dt},LH:function(){return Ye},oh:function(){return lr},Mh:function(){return Zt},Mb:function(){return Xt}});var gn=v(97857),d=v.n(gn),yn=v(5574),oe=v.n(yn),Sn=v(15009),ue=v.n(Sn),Cn=v(99289),$e=v.n(Cn),Pn=v(13769),M=v.n(Pn),bn=v(97269),P=v(67294),Fn=v(9783),p=v.n(Fn),Rn=v(52677),Se=v.n(Rn);function Ve(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t={};return Object.keys(r).forEach(function(a){var i=r[a];Se()(i)==="object"&&!Array.isArray(i)&&(i=Ve(i));var e=a.split("_"),n=oe()(e,2),o=n[0],l=n[1],s=o.split(",");if(s.length>1){var u,f,m=oe()(s,2),h=m[0],c=m[1],y=l?l.split(","):[],S=oe()(y,2),R=S[0],T=R===void 0?"value":R,b=S[1],C=b===void 0?"label":b;t[h]=(u=i)===null||u===void 0?void 0:u[T],t[c]=(f=i)===null||f===void 0?void 0:f[C]}else t[a]=i}),t}function Tn(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,a=t.split("_"),i=oe()(a,2),e=i[0],n=i[1],o=e.split(",");if(o.length>1){var l,s=oe()(o,2),u=s[0],f=s[1],m=n?n.split(","):[],h=oe()(m,2),c=h[0],y=c===void 0?"value":c,S=h[1],R=S===void 0?"label":S;return r[u]===void 0&&r[f]===void 0?void 0:(l={},p()(l,y,r[u]),p()(l,R,r[f]),l)}else return r[t]}function Ne(r){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return r&&(Object.keys(t).forEach(function(a){var i=t[a];Se()(i)==="object"&&Ne(r[a],i),$n(a)&&(r[a]=Tn(r,a))}),r)}function $n(r){return r&&typeof r=="string"&&r.includes(",")}var In=v(64759),Le=v(12902),xn=v(12936),Dn=v(71230),ke=P.createContext(void 0),Ze=P.createContext(void 0),He=P.createContext(void 0),We=P.createContext(void 0),Kn=v(62387),Ie=v(22270),On=v(77607),jn=v(51812),Vn=v(15746),F=v(85893),ze=function r(t){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"form",i=arguments.length>2?arguments[2]:void 0,e=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},n=e.labelCol,o=n===void 0?{}:n,l=e.valueBaseName,s=e.grid,u=e.colProps,f=u===void 0?{}:u,m=e.readonly,h=m===void 0?!1:m;return t.filter(function(c){return!(c.hideInForm&&a==="form")}).sort(function(c,y){return y.order||c.order?(y.order||0)-(c.order||0):(y.index||0)-(c.index||0)}).map(function(c,y){var S,R=(0,Ie.h)(c.title,c,"form",(0,F.jsx)(On.G,{label:c.title,tooltip:c.tooltip||c.tip})),T=function(I,K){if(K){if(typeof I=="string")return[K,I];if(Array.isArray(I))return[K].concat(I)}return I},b=(0,jn.Y)(d()(d()({},c),{},{title:R,label:R,valueType:(0,Ie.h)(c.valueType,{}),dataIndex:T(c.key||c.dataIndex,l),readonly:c.readonly||h,tooltip:c.tooltip||c.tip,getFieldProps:c.fieldProps?function(){return(0,Ie.h)(c.fieldProps,i,c)}:void 0,getFormItemProps:c.formItemProps?function(){return(0,Ie.h)(d()({labelCol:o},c.formItemProps),i,c)}:function(){return{labelCol:o}}})),C=b.key||((S=b.dataIndex)===null||S===void 0?void 0:S.toString())||y;b.key=C,b.name=b.name||b.dataIndex;var $=(0,Kn.E)(b,{action:void 0,type:"form",originItem:c,formRef:{current:i},genItems:function(I){return r(I,a,i,{labelCol:o,valueBaseName:l,grid:s,colProps:f,readonly:h})}});return s&&$&&b.valueType!=="dependency"?(0,F.jsx)(Vn.Z,d()(d()(d()({},f),b.colProps),{},{children:$}),C):$}).filter(function(c){return!!c})},Ln=v(12444),he=v.n(Ln),Bn=v(72004),me=v.n(Bn),xe=function(){function r(){he()(this,r),p()(this,"data",void 0),this.data={}}return me()(r,[{key:"setData",value:function(a){this.data=d()(d()({},this.setData),a)}}]),r}(),Mn=["embed","readonly","submitter","columns","valueBaseName","initialValues","onFinish","formRef","innerRef"],Ce=function(t,a){var i=a.isInit,e=i===void 0?!1:i,n=a.getFieldsValue,o=a.setFieldsValue,l=a.setInitialValuesInner,s=function(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=n(!0,function(){return!0}),h=Ne(t,m);if(e&&f){l(h);return}o(h)};s(),setTimeout(function(){return s(!0)},50)},wn=function(t){var a=t.embed,i=a===void 0?!1:a,e=t.readonly,n=e===void 0?!1:e,o=t.submitter,l=o===void 0?!1:o,s=t.columns,u=s===void 0?[]:s,f=t.valueBaseName,m=t.initialValues,h=t.onFinish,c=t.formRef,y=t.innerRef,S=M()(t,Mn),R=(0,P.useRef)(),T=(0,P.useRef)(new xe),b=(0,P.useContext)(Ge),C=function(){return b||y||R};(0,P.useEffect)(function(){var O=C();O.current||(O.current=T.current),O.current.data||(O.current.data=T.current.data),O.current.setData||(O.current.setData=T.current.setData)},[]);var $=(0,P.useState)(void 0),x=oe()($,2),I=x[0],K=x[1];(0,P.useEffect)(function(){if(m&&B.current){var O=B.current,j=O.getFieldsValue,V=O.setFieldsValue;Ce(m,{getFieldsValue:j,setFieldsValue:V,setInitialValuesInner:K,isInit:!0})}},[]);var B=(0,P.useRef)(),E=(0,P.useRef)();(0,P.useImperativeHandle)(c,function(){if(!I&&B.current){var O=B.current,j=O.getFieldsValue,V=O.setFieldsValue;return d()(d()({},B.current),{},{setFieldsValue:function(te){var w;Ce(te,{getFieldsValue:j,setFieldsValue:V}),(w=C().current)===null||w===void 0||w.setData(te||{})}})}if(!E.current)return E.current;var U=E.current,D=U.getFieldsValue,_=U.setFieldsValue;return d()(d()({},E.current),{},{setFieldsValue:function(te){var w;Ce(te,{getFieldsValue:D,setFieldsValue:_}),(w=C().current)===null||w===void 0||w.setData(te||{})}})},[!I]);var H=function(){return I?E:B},A=(0,P.useContext)(He)||{},z=function(){var O=$e()(ue()().mark(function j(V){return ue()().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:if(!h){D.next=2;break}return D.abrupt("return",h(Ve(V)));case 2:case"end":return D.stop()}},j)}));return function(V){return O.apply(this,arguments)}}(),Y=function O(j){var V=C();return(0,Le.Uy)(j,function(U){U.forEach(function(D){var _=D.renderFormItem,ae=D.fieldProps,te=D.valueType,w=D.columns,Z=D.formItemProps,we=Z===void 0?{}:Z,hn=D.required,Ee=D.render;hn&&!we.rules&&(D.formItemProps=d()(d()({},we),{},{rules:[{required:!0}]})),ae&&typeof ae=="function"&&(D.fieldProps=function(se,pe){return ae(se,V,pe)}),_&&(D.renderFormItem=function(se,pe,ve){return _(se,pe,ve,V)}),Ee&&(D.render=function(se,pe){for(var ve,Re,Ae=(ve=H().current)===null||ve===void 0?void 0:ve.getFieldsValue(),Ue=((Re=C().current)===null||Re===void 0?void 0:Re.data)||{},J=arguments.length,W=new Array(J>2?J-2:0),ye=2;ye<J;ye++)W[ye-2]=arguments[ye];return Ee.apply(void 0,[se,d()(d()(d()(d()({},pe),I||{}),Ue),Ae)].concat(W))}),w&&Array.isArray(w)&&(D.columns=O(w)),te==="dependency"&&w&&typeof w=="function"&&(D.columns=function(se){return O(w(se))})})})},k=xn.Z.useFormInstance();if(i){var G=t.grid,X=t.rowProps,Q=t.colProps,q=t.labelCol;return G?(0,F.jsx)(Dn.Z,d()(d()({},X),{},{children:ze(Y(u),"form",k,{labelCol:q,valueBaseName:f,colProps:Q,grid:G,readonly:n})})):ze(Y(u),"form",k,{labelCol:q,valueBaseName:f,readonly:n})}var le=function(){if(Se()(l)==="object"){var j=l.render,V=l.style,U=V===void 0?{}:V;return j||(l.render=function(D,_){return(0,F.jsx)("div",{style:d()({display:"flex",alignItems:"center",gap:"8px"},U),children:_})}),l}return l},re=I?"hasInitial":"noInitial";return(0,F.jsx)(In.Z,d()(d()(d()({},A),{},{onFinish:z,submitter:le(),formRef:H(),readonly:n,initialValues:I},S),{},{columns:Y(u),layoutType:"Form"}),re)},Ye=wn,fr=function(){return null},En=["onFinish","formRef","initialValues","children","innerRef"],Ge=(0,P.createContext)(void 0),An=function(t){var a=t.onFinish,i=t.formRef,e=t.initialValues,n=t.children,o=t.innerRef,l=M()(t,En),s=(0,P.useRef)(),u=(0,P.useRef)(new xe),f=function(){return o||s};(0,P.useImperativeHandle)(f(),function(){return{data:u.current.data,setData:u.current.setData}});var m=function(){var C=$e()(ue()().mark(function $(x){return ue()().wrap(function(K){for(;;)switch(K.prev=K.next){case 0:if(!a){K.next=4;break}return K.next=3,a(Ve(x));case 3:return K.abrupt("return");case 4:return K.abrupt("return",new Promise(function(B){B(!0)}));case 5:case"end":return K.stop()}},$)}));return function(x){return C.apply(this,arguments)}}(),h=(0,P.useState)(void 0),c=oe()(h,2),y=c[0],S=c[1];(0,P.useEffect)(function(){if(e&&R.current){var C=R.current,$=C.getFieldsValue,x=C.setFieldsValue;Ce(e,{getFieldsValue:$,setFieldsValue:x,isInit:!0,setInitialValuesInner:S})}},[]);var R=(0,P.useRef)(),T=(0,P.useRef)();(0,P.useImperativeHandle)(i,function(){if(!y)return R.current;if(!T.current)return T.current;var C=T.current,$=C.getFieldsValue,x=C.setFieldsValue;return d()(d()({},T.current),{},{setFieldsValue:function(K){return Ce(K,{getFieldsValue:$,setFieldsValue:x})}})},[!y]);var b=y?"hasInitial":"noInitial";return(0,F.jsx)(Ge.Provider,{value:f(),children:(0,F.jsx)(bn.A,d()(d()({onFinish:m,formRef:b==="hasInitial"?T:R,initialValues:y},l),{},{children:n}),b)})},Un=An,Nn=v(25098),g=v.n(Nn),kn=v(31996),Pe=v.n(kn),Zn=v(26037),be=v.n(Zn),Be=v(17788),Qe=v(73505),Hn=v(70942);function ee(r,t){typeof window!="undefined"?(window[r]||(window[r]={}),window[r]=d()(d()({},window[r]),t)):(v.g[r]||(v.g[r]={}),v.g[r]=d()(d()({},v.g[r]),t))}function L(){for(var r=typeof window!="undefined"?window:v.g,t=0;t<arguments.length;t++){var a=t<0||arguments.length<=t?void 0:arguments[t];if(!r[a])return;r=r[a]}return r}function ie(){for(var r=typeof window!="undefined"?window:v.g,t=0;t<arguments.length;t++){var a=t<0||arguments.length<=t?void 0:arguments[t];if(!r[a])return;t===arguments.length-1&&delete r[a],r=r[a]}}var ce=Hn.bind({ignoreUndefined:!0});function De(r){if(Se()(r)!=="object"||r===null)return!1;var t=Object.getPrototypeOf(r);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in r)&&!(Symbol.iterator in r)}var Wn=function(t,a,i){var e=t||i;if(a===!1)return!1;if(a===void 0)return t||i;if(De(a)&&!De(e))return a;if(De(a)&&De(e))return ce(e,a)},zn=function(t,a,i){return(0,Qe.Z)(a)?a:(0,Qe.Z)(t)?t:i},Yn=["children"];function Je(r){return cloneDeepWith(r,function(t){if(isElement(t)||isValidElement(t))return!0})}function Xe(r,t,a){var i=a||{},e=i.replace,n=t?t(r)||{}:{},o=e?d()({},n):d()(d()({},r),n);if(!o.children){var l=o.children,s=M()(o,Yn);return s}return d()(d()({},o),{},{children:o.children?o.children.map(function(u){return Xe(u,t,a)}):[]})}function qe(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,a=arguments.length>2?arguments[2]:void 0,i=a||{},e=i.replace,n=e===void 0?!1:e;return r.map(function(o){return Xe(o,t,{replace:n})})}function Gn(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=a===0?Je(r):r,e=[];return i.forEach(function(n){var o=t(n);if(o)return o&&n.children&&(n.children=Gn(n.children,t,a+1)),e.push(n)}),e}function Qn(){for(var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,e,n=i===0?Je(r):r,o=0;o<n.length;o++){var l=n[o],s=Jn(l,t,a,i);if(s){e=s;break}else a.splice(i)}return i>0?e:a}function Jn(r,t,a,i){if(a.push(r),t(r))return r;if(r.children&&r.children.length)return Qn(r.children,t,a,i+1)}var Xn=["width"],qn=["columns","onFinish","onCancel","formProps","styles","innerRef","open"],_n=["isKeyPressSubmit","autoFocusFirstInput","initialValues"],et=["styles"],_e=function(r){Pe()(a,r);var t=be()(a);function a(i){var e,n;he()(this,a),n=t.call(this,i),p()(g()(n),"formRef",void 0),p()(g()(n),"selfInnerRef",void 0),p()(g()(n),"baseInnerObj",void 0),p()(g()(n),"context",void 0),p()(g()(n),"componentDidUpdate",function(){var l=$e()(ue()().mark(function s(u,f){return ue()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(!(!u.open&&n.props.open)){h.next=6;break}if(!n.props.onOpen){h.next=6;break}return n.setState({loading:!0}),h.next=5,n.props.onOpen(n.state.formType,n.formRef,n.state.formData);case 5:n.setState({loading:!1});case 6:if(!(!f.visible&&n.state.visible)){h.next=12;break}if(!n.props.onOpen){h.next=12;break}return n.setState({loading:!0}),h.next=11,n.props.onOpen(n.state.formType,n.formRef,n.state.formData);case 11:n.setState({loading:!1});case 12:case"end":return h.stop()}},s)}));return function(s,u){return l.apply(this,arguments)}}()),p()(g()(n),"getInnerRef",function(){return n.props.innerRef||n.selfInnerRef}),p()(g()(n),"openModal",function(){var l,s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"new",u=arguments.length>1?arguments[1]:void 0,f=n.getInnerRef();if(f.current.formType=s,u){n.setState({visible:!0,formType:s,formData:u});return}n.setState({visible:!0,formType:s,formData:((l=n.props.formProps)===null||l===void 0?void 0:l.initialValues)||{}})}),p()(g()(n),"onOk",function(){if(n.formRef.current){var l=n.formRef.current.submit;l()}}),p()(g()(n),"onFinish",function(){var l=$e()(ue()().mark(function s(u){var f,m,h,c;return ue()().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(f=n.props.onFinish,m=n.state,h=m.formType,c=m.formData,n.setState({loading:!0}),!f){S.next=15;break}return S.prev=4,S.next=7,f(u,h,c);case 7:n.setState({loading:!1}),n.getOnCancel(),S.next=15;break;case 11:S.prev=11,S.t0=S.catch(4),console.log("onFinishError",S.t0),n.setState({loading:!1});case 15:case"end":return S.stop()}},s,null,[[4,11]])}));return function(s){return l.apply(this,arguments)}}()),p()(g()(n),"handleOnCancel",function(){var l,s=n.props,u=s.getContainer,f=s.confirmOnClose,m=f===void 0?!0:f,h=(l=n.formRef.current)===null||l===void 0?void 0:l.isFieldsTouched();m&&h?Be.Z.confirm({title:"\u786E\u8BA4\u5173\u95ED\u5F39\u7A97\u5417?",content:"\u5173\u95ED\u5F39\u7A97\u540E\u60A8\u6240\u66F4\u6539\u7684\u5185\u5BB9\u5C06\u4E0D\u4F1A\u4FDD\u5B58!",centered:!0,closable:!0,onOk:function(){n.getOnCancel()},getContainer:u}):n.getOnCancel()}),p()(g()(n),"getOnCancel",function(){var l=n.props,s=l.onCancel,u=l.open;u?s&&s():n.setState({visible:!1})}),p()(g()(n),"getColumns",function(){var l=qe(n.props.columns,function(s){var u=s.width,f=M()(s,Xn);return f},{replace:!0});return l}),n.state={visible:!1,formData:((e=i.formProps)===null||e===void 0?void 0:e.initialValues)||{},formType:"new",loading:!1},n.selfInnerRef=(0,P.createRef)(),n.formRef=(0,P.createRef)(),n.baseInnerObj=new xe;var o=n.getInnerRef();return o.current||(o.current={}),o.current.openModal=n.openModal,o.current.data||(o.current.data=n.baseInnerObj.data),o.current.setData||(o.current.setData=n.baseInnerObj.setData),n}return me()(a,[{key:"render",value:function(){var e=this.state.formType,n=this.props,o=n.columns,l=n.onFinish,s=n.onCancel,u=n.formProps,f=n.styles,m=n.innerRef,h=n.open,c=M()(n,qn),y=u||{},S=y.isKeyPressSubmit,R=S===void 0?!0:S,T=y.autoFocusFirstInput,b=T===void 0?!0:T,C=y.initialValues,$=M()(y,_n),x=this.context||{},I=x.modalProps,K=I===void 0?{}:I,B=x.formProps,E=B===void 0?{}:B,H=ce(E,{innerRef:this.getInnerRef()},$),A=K.styles,z=M()(K,et),Y=ce(z,c),k=ce({body:{maxHeight:"calc(100vh - 108px - 100px - 25px)",overflow:"auto"}},A,f);return(0,F.jsx)(Be.Z,d()(d()({destroyOnClose:!0,styles:k,open:h||this.state.visible},Y),{},{onCancel:this.handleOnCancel,onOk:this.onOk,okButtonProps:{loading:this.state.loading},children:(0,F.jsx)(Ye,d()({scrollToFirstError:!0,formRef:this.formRef,columns:this.getColumns(),onFinish:this.onFinish,autoFocusFirstInput:b,isKeyPressSubmit:R,initialValues:h?C:d()({},this.state.formData),readonly:e==="read"},H))}))}}]),a}(P.Component);p()(_e,"contextType",Ze);var en=_e,cr=function(){return null},nt=v(40762),nn=v(78957),tn=v(86738),tt=v(68872),rt=v(14726),at=["visible"],ot=function(t){var a=t.visible,i=a===void 0?!0:a,e=M()(t,at);return typeof i=="function"&&!i()||!i?null:(0,F.jsx)(rt.ZP,d()({},e))},rn=ot,pr=function(){return null},vr=v(97560),it=["className"],lt=function(t){var a=t.className,i=M()(t,it);return(0,F.jsx)(rn,d()(d()({className:"rak-link-btn "+(a||"")},i),{},{type:"link"}))},ge=lt,st=null,ut=function(t){return t.filter(function(a){return!a.hideInTable}).filter(function(a){var i=typeof a.valueType=="string"?a.valueType:"";return!["option","index"].includes(i)})},hr=function(t){return t.filter(function(a){return!a.hideInSearch}).filter(function(a){var i=typeof a.valueType=="string"?a.valueType:"";return!["option","index"].includes(i)}).map(function(a){var i=a.hideInForm,e=a.formItemProps,n=_objectWithoutProperties(a,st);return n})},mr=function(t){return t.filter(function(a){return!a.hideInForm}).filter(function(a){var i=typeof a.valueType=="string"?a.valueType:"";return!["option","index"].includes(i)})},gr=function(t){return t.filter(function(a){return!a.hideInTable})},yr=function(t){var a={};return t.filter(function(i){return i.sorter===!0}).forEach(function(i){var e=i.defaultSortOrder||"descend";a[i.dataIndex]=e}),a},an=function(t,a){if(Object.keys(a).length<1)return t;var i={ascend:"asc",descend:"desc"},e=Object.keys(a)[0],n={sort:"".concat(e,",").concat(i[a[e]])};return d()(d()({},t),n)},Sr=function(t){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"asc",i={asc:"ascend",desc:"descend"},e=a==="asc"?["ascend","descend","ascend"]:["descend","ascend","descend"];return{defaultSortOrder:i[a],sortDirections:e,sorter:!0}},dt=v(94184),ft=v.n(dt),ct=v(12823),pt=v(93162),vt=v(30381),ht=v.n(vt),mt=20;function Ke(r,t){return r?typeof r=="string"?r:ht()(r).format(t):""}function gt(r,t){if(t.valueEnum){var a;return(a=t.valueEnum[r])===null||a===void 0?void 0:a.text}if(t.fieldProps)if(typeof t.fieldProps=="function"){var i,e,n=((i=t.fieldProps({},{current:{}},t))===null||i===void 0?void 0:i.options)||[];return(e=n.find(function(u){return u.value==r}))===null||e===void 0?void 0:e.label}else{var o,l,s=((o=t.fieldProps)===null||o===void 0?void 0:o.options)||[];return(l=s.find(function(u){return u.value==r}))===null||l===void 0?void 0:l.label}}function yt(r,t){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=typeof t.dataIndex=="string"?r[t.dataIndex]:"";return t.renderExport?t.renderExport(i,r):t.render?t.render(i,r,a,void 0,void 0):t.renderText?t.renderText(i,r,a):["select","radio","radioButton","checkbox"].includes(t.valueType||"")?gt(i,t):t.valueType==="date"?Ke(i,"YYYY-MM-DD"):t.valueType==="dateTime"?Ke(i,"YYYY-MM-DD HH:mm:ss"):t.valueType==="dateRange"&&i?i.map(function(e){return Ke(e,"YYYY-MM-DD")}).join(" - "):t.valueType==="dateTimeRange"&&i?i.map(function(e){return Ke(e,"YYYY-MM-DD HH:mm:ss")}).join(" - "):t.valueType==="money"?i||"":i&&Se()(i)==="object"?i.value:i}function St(r,t){r.xlsx.writeBuffer().then(function(a){var i=new Blob([a],{type:""});(0,pt.saveAs)(i,t)})}var Ct=function(t,a){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"\u9ED8\u8BA4\u5BFC\u51FA",e=new ct.Workbook,n=e.addWorksheet("sheet1");n.properties.defaultRowHeight=20,n.columns=t.map(function(l){return{header:typeof l.title=="string"?l.title:"",key:typeof l.dataIndex=="string"?l.dataIndex:Date.now().toString(),width:l.width?Number(l.width)/5:mt}}),n.columns.forEach(function(l){l.alignment={vertical:"middle"}}),console.log("\u5BFC\u51FA",a);var o=(a||[]).map(function(l,s){return t.map(function(u){return yt(l,u,s)})});n.addRows(o),(a||[]).forEach(function(l,s){t.forEach(function(u,f){var m=u.onCell?u.onCell(l)||{}:{},h=m.rowSpan;if(h>1){var c=s+2,y=f+1;n.mergeCells(c,y,c+h-1,y)}})}),St(e,i+".xlsx")},Pt=["children","title","content","onOk"],bt=Be.Z.confirm,Ft=function(t){var a=t.children,i=t.title,e=t.content,n=t.onOk,o=M()(t,Pt),l=function(u){u.stopPropagation(),bt(d()({title:i,content:e,onOk:n},o))};return P.cloneElement(a,{onClick:l})},on=Ft,Cr=v(59700),Rt=["title"],Tt=["btnText","title"],$t=["rowKey","name","columns","options","pagination","formColumns","scroll","onFinish","tableAlertOption","rowSelection","sticky","className","optionColSpaceSize","noPadding","search","request","onOpen","modalProps","formProps","defaultHideInSearch","confirmModalProps","confirmModelType","optionColumnSpaceProps","actionRef"],It=["modalProps","formProps","searchConfig","options","defaultHideInSearch","confirmModalType","confirmModalProps","tableAlertOption"],xt={new:"\u65B0\u589E",edit:"\u7F16\u8F91",read:"\u67E5\u770B"},ln=function(r){Pe()(a,r);var t=be()(a);function a(i){var e;return he()(this,a),e=t.call(this,i),p()(g()(e),"targetId",void 0),p()(g()(e),"selfInnerRef",void 0),p()(g()(e),"selfActionRef",void 0),p()(g()(e),"baseInnerObj",void 0),p()(g()(e),"context",void 0),p()(g()(e),"tableReload",function(){var n,o=e.props.actionRef||e.selfActionRef;(n=o.current)===null||n===void 0||n.reload()}),p()(g()(e),"getInnerRef",function(){return e.props.innerRef||e.selfInnerRef}),p()(g()(e),"getTitle",function(){var n=e.props,o=n.name,l=n.toolbar,s=l===void 0?{}:l,u=s.title;return u||(o?"".concat(o,"\u5217\u8868"):!1)}),p()(g()(e),"getModalTitle",function(){var n=e.props.name,o=n===void 0?"":n,l=e.state.formType;return"".concat(xt[l]).concat(o)||""}),p()(g()(e),"patchColumn",function(n){var o=e.context||{},l=o.optionColumnSpaceProps,s=e.props.optionColumnSpaceProps,u=s===void 0?{}:s,f=e.getInnerRef(),m=ce({size:"small"},l,u);return(0,Le.ZP)(n,function(h){h.forEach(function(c){var y=c.render;c.valueType==="option"&&y&&(c.render=function(S,R,T,b){var C=y(S,R,T,b,f);return Array.isArray(C)?(0,F.jsx)(nn.Z,d()(d()({},m),{},{children:C})):C})})})}),p()(g()(e),"enableDelete",function(n){var o=e.context||{},l=o.confirmModalType,s=o.confirmModalProps,u=e.props,f=u.rowKey,m=f===void 0?"id":f,h=u.delPermission,c=u.delFunction,y=u.confirmModelType,S=y===void 0?l||"popconfirm":y,R=u.confirmModalProps,T=R===void 0?{}:R,b=ce(s,T),C=h?h():!0,$=e.state.delLoading;return(0,Le.ZP)(n,function(x){x.forEach(function(I){var K=I.render,B=I.enableDelete,E=B===void 0?!1:B;I.valueType==="option"&&c&&C&&E&&K&&(I.render=function(H,A,z,Y,k){var G=typeof m=="function"?m(A):m,X=typeof E=="function"?E(A,z):{},Q=X.disabled,q=Q===void 0?!1:Q,le=X.visible,re=le===void 0?!0:le,O=X.danger,j=X.btnText,V=j===void 0?"\u5220\u9664":j,U=K(H,A,z,Y,k);if(Array.isArray(U)&&re){var D,_=b.title,ae=_===void 0?"\u786E\u5B9A\u5220\u9664\u5417?":_,te=M()(b,Rt);S==="modal"?D=(0,F.jsx)(on,d()(d()({title:ae},te),{},{onOk:function(){e.handleDelete([A[G]],A)},children:(0,F.jsx)(ge,{disabled:q,onClick:function(Z){return Z.stopPropagation()},loading:$&&A[G]===e.targetId,danger:O,children:V})}),U.length+1):D=(0,F.jsx)(tn.Z,d()(d()({title:ae},te),{},{onConfirm:function(Z){Z==null||Z.stopPropagation(),e.handleDelete([A[G]],A)},onCancel:function(Z){return Z==null?void 0:Z.stopPropagation()},children:(0,F.jsx)(ge,{disabled:q,onClick:function(Z){return Z.stopPropagation()},loading:$&&A[G]===e.targetId,danger:O,children:V})}),U.length+1),U.push(D)}return U})})})}),p()(g()(e),"getRowSelection",function(){var n=e.props.rowSelection,o=e.state.selectedRowKeys;return n&&!n.selectedRowKeys?d()(d()({},n),{},{selectedRowKeys:o,onChange:function(s,u){return e.setState({selectedRowKeys:s,selectedRows:u})}}):n}),p()(g()(e),"handleDelete",function(n,o,l){var s=e.props,u=s.rowKey,f=u===void 0?"id":u,m=s.delFunction,h=s.rowSelection,c=h===void 0?{}:h,y=s.actionRef,S=y===void 0?e.selfActionRef:y,R=typeof f=="function"?f(o):f;e.setState({delLoading:!0}),o[R]&&(e.targetId=o[R]),m&&m(n,o).then(function(){if(tt.ZP.success("\u5220\u9664\u6210\u529F!"),l&&l(),o[R]&&c){var T=(n||[]).filter(function(E){return E!==o[R]});c.selectedRowKeys?c.onChange&&c.onChange(T):e.setState({selectedRowKeys:T})}var b=S.current;if(b){var C=b.pageInfo,$=C.current,x=C.total,I=C.pageSize,K=o.id?1:(n||[]).length,B=x-K===($-1)*I;if($>1&&B){b.setPageInfo({current:$-1});return}b.reload()}}).finally(function(){e.setState({delLoading:!1})})}),p()(g()(e),"tableAlertOptionRender",function(n){var o=n.selectedRowKeys,l=n.onCleanSelected,s=e.state,u=s.delLoading,f=s.selectedRows,m=e.context||{},h=m.tableAlertOption,c=e.props,y=c.tableAlertOption,S=y===void 0?{}:y,R=c.columns,T=c.name,b=c.delFunction,C=c.delPermission,$=c.confirmModelType,x=ce(h,S),I=x.hideDelete,K=I===void 0?!1:I,B=x.enableExport,E=B===void 0?!1:B,H=x.actions,A=H===void 0?[]:H,z=x.exportName,Y=x.deleteProps,k=Y||{},G=k.btnText,X=G===void 0?"\u6279\u91CF\u5220\u9664":G,Q=k.title,q=M()(k,Tt),le=C?C():!0,re=function(){if(!K&&b&&le){var j=Q?Q(o.length):"\u786E\u5B9A\u5220\u9664".concat(o.length,"\u6761\u6570\u636E\u5417?");return $==="modal"?(0,F.jsx)(on,d()(d()({title:j},q),{},{onOk:function(){e.handleDelete(o,{},l)},okButtonProps:{loading:u},children:(0,F.jsx)(ge,{loading:u,children:X})})):(0,F.jsx)(tn.Z,d()(d()({overlayStyle:{width:"180px"},title:j},q),{},{onConfirm:function(){e.handleDelete(o,{},l)},okButtonProps:{loading:u},children:(0,F.jsx)(ge,{loading:u,children:X})}))}};return(0,F.jsxs)(nn.Z,{size:"middle",children:[E&&(0,F.jsx)(ge,{onClick:function(){Ct(ut(R),f,z||"".concat(T?T+"\u5217\u8868":"","\u5BFC\u51FA")),l()},children:"\u5BFC\u51FA\u6240\u9009"}),re(),A,(0,F.jsx)("a",{onClick:l,children:"\u53D6\u6D88\u9009\u62E9"})]})}),p()(g()(e),"selfOnOpen",function(n,o,l){e.setState({formType:n}),e.props.onOpen&&e.props.onOpen(n,o,l)}),e.state={formType:"",delLoading:!1,selectedRowKeys:[],selectedRows:[]},e.targetId="",e.selfInnerRef=(0,P.createRef)(),e.selfActionRef=(0,P.createRef)(),e.baseInnerObj=new xe,e.getInnerRef().current={},e.getInnerRef().current.data=e.baseInnerObj.data,e.getInnerRef().current.setData=e.baseInnerObj.setData,e}return me()(a,[{key:"componentDidMount",value:function(){document.addEventListener("reload",this.tableReload)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("reload",this.tableReload)}},{key:"render",value:function(){var e=this,n=this.props,o=n.rowKey,l=o===void 0?"id":o,s=n.name,u=n.columns,f=n.options,m=n.pagination,h=m===void 0?{}:m,c=n.formColumns,y=n.scroll,S=y===void 0?{x:"100%"}:y,R=n.onFinish,T=n.tableAlertOption,b=n.rowSelection,C=n.sticky,$=C===void 0?!0:C,x=n.className,I=n.optionColSpaceSize,K=n.noPadding,B=K===void 0?!1:K,E=n.search,H=n.request,A=n.onOpen,z=n.modalProps,Y=z===void 0?{}:z,k=n.formProps,G=k===void 0?{}:k,X=n.defaultHideInSearch,Q=n.confirmModalProps,q=n.confirmModelType,le=n.optionColumnSpaceProps,re=n.actionRef,O=M()(n,$t),j=this.context||{},V=j.modalProps,U=V===void 0?{}:V,D=j.formProps,_=D===void 0?{}:D,ae=j.searchConfig,te=ae===void 0?{}:ae,w=j.options,Z=j.defaultHideInSearch,we=j.confirmModalType,hn=j.confirmModalProps,Ee=j.tableAlertOption,se=M()(j,It),pe=d()(d()({},se),O),ve=d()(d()({},U),Y),Re=d()(d()({},te),{},{className:"searchFormStyleFix"}),Ae=Wn(w,f,!1),Ue=zn(Z,X,!1);return(0,F.jsxs)(F.Fragment,{children:[(0,F.jsx)(nt.ZP,d()({className:ft()(x,I==="small"&&"myTableSmallOptionCol",B&&"rak-protable-no-padding"),rowKey:l,headerTitle:this.getTitle(),columns:this.patchColumn(this.enableDelete(qe(u,function(J){var W=d()({},J);return W.hideInSearch===void 0&&(W.hideInSearch=Ue),W.type==="search"&&(W.search=!0,W.hideInSearch=!1,W.hideInTable=!0,W.hideInForm=!0),W}))).filter(function(J){return!(J.valueType==="dependency"||J.type==="form")}),options:Ae,pagination:h,scroll:S,tableAlertOptionRender:this.tableAlertOptionRender,rowSelection:this.getRowSelection(),sticky:$,search:E===!1?!1:d()(d()({},Re),E),request:H?function(J,W,ye){return new Promise(function(sr,ur){H(an(J,W),W,ye).then(function(Te){var je=e.getInnerRef();je&&(je.current.total=Te.total,je.current.dataSource=Te.data,je.current.params=an(J,W)),sr(Te)}).catch(function(Te){return ur(Te)})})}:void 0,actionRef:re||this.selfActionRef},pe)),(0,F.jsx)(en,d()({innerRef:this.getInnerRef(),title:this.getModalTitle(),columns:(c||u).filter(function(J){return J.type==="form"||!J.type}),onFinish:R,onOpen:this.selfOnOpen,formProps:d()(d()({},_),G)},ve))]})}}]),a}(P.Component);p()(ln,"contextType",ke);var Dt=ln,sn=v(34041),Me=v(66690),Kt=v(44421);function un(r,t,a,i){var e=i||{},n=e.parentKey,o=e.icon,l=e.isTop;return r.children?_objectSpread(_objectSpread({},r),{},{key:r[a],title:r[t],nodeId:n,isTop:l,icon:o,children:r.children.map(function(s){return un(s,t,a,{parentKey:r[a],icon:o})})}):_objectSpread(_objectSpread({},r),{},{key:r[a],title:r[t],nodeId:n,isTop:l})}function Pr(r,t){var a=t||{},i=a.titleKey,e=i===void 0?"title":i,n=a.valueKey,o=n===void 0?"id":n,l=a.icon;return r.map(function(s){return un(s,e,o,{parentKey:"",icon:l||s.icon,isTop:!0})})}function dn(r,t,a){return r.children?d()(d()({},r),{},{value:r[a],title:r[t],children:r.children.map(function(i){return dn(i,t,a)})}):d()(d()({},r),{},{value:r[a],title:r[t]})}function Oe(r,t){var a=t||{},i=a.titleKey,e=i===void 0?"label":i,n=a.valueKey,o=n===void 0?"id":n;return r.map(function(l){return dn(l,e,o)})}function fn(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,a=t||{},i=a.labelKey,e=i===void 0?"name":i,n=a.valueKey,o=n===void 0?"id":n,l=a.renderLabel;return r.map(function(s){var u;return l?u=l(s):u=s[e],{label:u,value:s[o]}})}function cn(r,t){return r.children?d()(d()({},r),{},{disabled:t&&t(r),children:r.children.map(function(a){return cn(a,t)})}):d()(d()({},r),{},{disabled:t&&t(r)})}function Ot(r,t){return t?r.map(function(a){return cn(a,t)}):r}function pn(r,t){return r.children?_objectSpread(_objectSpread({},r),{},{checkable:t&&t(r),children:r.children.map(function(a){return pn(a,t)})}):_objectSpread(_objectSpread({},r),{},{checkable:t&&t(r)})}function br(r,t){return t?r.map(function(a){return pn(a,t)}):r}function jt(){for(var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"id",i,e=0;e<r.length;e++){var n=Vt(r[e],t,a);if(n){i=n;break}}return i}function Vt(r,t,a){if(r[a]===t)return r;if(r.children&&r.children.length)return jt(r.children,t,a)}var Lt=["type","loadFunction","labelKey","valueKey","renderLabel","onChange","queryParams","noCache","showSearch","optionFilterProp","allowClear"],Bt=function(r){Pe()(a,r);var t=be()(a);function a(i){var e;return he()(this,a),e=t.call(this,i),p()(g()(e),"reRender",function(n){n.detail.type===e.props.type&&!e.isNoCache()&&(e.setState({loading:!1,dataSource:L(N,e.props.type)||[],total:L(ne,e.props.type)||0}),e.props.onLoad&&e.props.onLoad(L(N,e.props.type)||[],L(ne,e.props.type)||0),ee(de,p()({},e.props.type,!1)))}),p()(g()(e),"isNoCache",function(){var n=e.props,o=n.queryParams,l=o===void 0?{}:o,s=n.noCache;return Object.keys(l).length>0||s}),p()(g()(e),"handleLoadData",function(){e.isNoCache()?e.loadDataWithoutCache():e.loadDataForCache()}),p()(g()(e),"loadDataForCache",function(){var n=e.props,o=n.type,l=n.loadFunction,s=n.onLoad;if(L(de,o)){e.setState({loading:!0});return}if(L(N,o)){s&&s(L(N,o)||[],L(ne,o));return}ee(de,p()({},o,!0)),e.setState({loading:!0}),l({}).then(function(u){ee(N,p()({},o,u.data)),ee(ne,p()({},o,u.total)),s&&s(u.data,u.total);var f=new CustomEvent("selectGlobalUpdate",{detail:{type:o}});document.dispatchEvent(f)}).finally(function(){e.setState({loading:!1})})}),p()(g()(e),"loadDataWithoutCache",function(){var n=e.props,o=n.loadFunction,l=n.queryParams,s=l===void 0?{}:l,u=n.onLoad;e.setState({loading:!0}),o(s).then(function(f){e.setState({dataSource:f.data,total:f.total}),u&&u(f.data,f.total)}).finally(function(){e.setState({loading:!1})})}),p()(g()(e),"getTotal",function(){return e.isNoCache()?e.state.total:L(ne,e.props.type)}),p()(g()(e),"reset",function(){var n=e.props.type;e.setState({searchValue:void 0,dataSource:L(N,n)||[],total:L(ne,n),current:1}),e.isNoCache()&&e.handleLoadData()}),p()(g()(e),"handleOnChange",function(n){var o=e.props,l=o.onChange,s=o.valueKey,u=s===void 0?"id":s,f=o.labelInValue;if(!n){e.reset(),l&&l(n,{});return}n&&e.state.searchValue&&e.reset(),l&&l(n,e.state.dataSource.find(function(m){return f?m[u]===(n==null?void 0:n.value):m[u]===n}))}),p()(g()(e),"handleUpdateData",function(){var n=e.state,o=n.current,l=n.searchValue,s=n.dataSource,u=e.props.queryParams,f=u===void 0?{}:u;e.setState({loading:!0}),e.props.loadFunction(d()(d()({},f),{},{current:o,searchValue:l})).then(function(m){e.setState({dataSource:s.concat(m.data),loading:!1,total:m.total}),l||ee(N,p()({},e.props.type,s.concat(m.data)))})}),p()(g()(e),"handleSearchData",function(){var n=e.state.searchValue,o=e.props.queryParams,l=o===void 0?{}:o;e.setState({loading:!0}),e.props.loadFunction(d()(d()({},l),{},{current:1,searchValue:n})).then(function(s){e.setState({dataSource:s.data,loading:!1,total:s.total})})}),p()(g()(e),"handlePopupScroll",function(n){n.persist();var o=n.target,l=e.state.current;e.toBottomNeedLoad(o)&&e.setState({current:l+1},e.handleUpdateData)}),p()(g()(e),"toBottomNeedLoad",function(n){var o=e.state,l=o.dataSource,s=o.loading;return!s&&e.toBottom(n)&&l.length<e.getTotal()}),p()(g()(e),"toBottom",function(n){return n.scrollTop+n.clientHeight+10>n.scrollHeight}),p()(g()(e),"handleSearch",function(n){if(n){e.setState({searchValue:n,current:1},function(){return e.handleSearchData()});return}e.reset()}),e.state={dataSource:L(N,i.type)||[],total:L(ne,i.type)||0,loading:!1,searchValue:"",current:1},e}return me()(a,[{key:"componentDidMount",value:function(){this.handleLoadData(),document.addEventListener("selectGlobalUpdate",this.reRender)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("selectGlobalUpdate",this.reRender)}},{key:"componentDidUpdate",value:function(e){(0,Me.Z)(e.queryParams,this.props.queryParams)||this.handleLoadData()}},{key:"render",value:function(){var e=this.props,n=e.type,o=e.loadFunction,l=e.labelKey,s=l===void 0?"name":l,u=e.valueKey,f=u===void 0?"id":u,m=e.renderLabel,h=e.onChange,c=e.queryParams,y=e.noCache,S=e.showSearch,R=e.optionFilterProp,T=e.allowClear,b=M()(e,Lt),C=S!==void 0?S:!0,$=T!==void 0?T:!0;return(0,F.jsx)(sn.Z,d()(d()({},b),{},{loading:this.state.loading,onChange:this.handleOnChange,options:fn(this.state.dataSource,{labelKey:s,valueKey:f,renderLabel:m}),showSearch:C,allowClear:$,filterOption:!1,onPopupScroll:this.handlePopupScroll,onSearch:(0,Kt.Z)(this.handleSearch,500)}))}}]),a}(P.Component),Mt=Bt,wt=["type","loadFunction","labelKey","valueKey","renderLabel","onChange","queryParams","noCache","showSearch","optionFilterProp","allowClear"],Et=function(r){Pe()(a,r);var t=be()(a);function a(i){var e;return he()(this,a),e=t.call(this,i),p()(g()(e),"reRender",function(n){n.detail.type===e.props.type&&!e.isNoCache()&&(e.setState({loading:!1,dataSource:L(N,e.props.type)||[],total:L(ne,e.props.type)||0}),e.props.onLoad&&e.props.onLoad(L(N,e.props.type)||[],L(ne,e.props.type)||0),ee(de,p()({},e.props.type,!1)))}),p()(g()(e),"isNoCache",function(){var n=e.props,o=n.queryParams,l=o===void 0?{}:o,s=n.noCache;return Object.keys(l).length>0||s}),p()(g()(e),"handleLoadData",function(){e.isNoCache()?e.loadDataWithoutCache():e.loadDataForCache()}),p()(g()(e),"loadDataForCache",function(){var n=e.props,o=n.type,l=n.loadFunction,s=n.onLoad;if(L(de,o)){e.setState({loading:!0});return}if(L(N,o)){s&&s(L(N,o)||[]);return}ee(de,p()({},o,!0)),e.setState({loading:!0}),l({}).then(function(u){ee(N,p()({},o,u.data)),ee(ne,p()({},o,u.total)),s&&s(u.data,u.total);var f=new CustomEvent("selectGlobalUpdate",{detail:{type:o}});document.dispatchEvent(f)}).finally(function(){e.setState({loading:!1})})}),p()(g()(e),"loadDataWithoutCache",function(){var n=e.props,o=n.loadFunction,l=n.queryParams,s=l===void 0?{}:l,u=n.onLoad;e.setState({loading:!0}),o(s).then(function(f){e.setState({dataSource:f.data,total:f.total}),u&&u(f.data,f.total)}).finally(function(){e.setState({loading:!1})})}),p()(g()(e),"handleOnChange",function(n){var o=e.props,l=o.onChange,s=o.valueKey,u=s===void 0?"id":s,f=o.labelInValue;if(!n){l&&l(n,{});return}l&&l(n,e.state.dataSource.find(function(m){return f?m[u]===(n==null?void 0:n.value):m[u]===n}))}),e.state={loading:!1,dataSource:L(N,i.type)||[]},e}return me()(a,[{key:"componentDidMount",value:function(){this.handleLoadData(),document.addEventListener("selectGlobalUpdate",this.reRender)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("selectGlobalUpdate",this.reRender)}},{key:"componentDidUpdate",value:function(e){(0,Me.Z)(e.queryParams,this.props.queryParams)||this.handleLoadData()}},{key:"render",value:function(){var e=this.props,n=e.type,o=e.loadFunction,l=e.labelKey,s=l===void 0?"name":l,u=e.valueKey,f=u===void 0?"id":u,m=e.renderLabel,h=e.onChange,c=e.queryParams,y=e.noCache,S=e.showSearch,R=e.optionFilterProp,T=e.allowClear,b=M()(e,wt),C=S!==void 0?S:!0,$=R!==void 0?R:"label",x=T!==void 0?T:!0;return(0,F.jsx)(sn.Z,d()(d()({},b),{},{loading:this.state.loading,onChange:this.handleOnChange,options:fn(this.state.dataSource,{labelKey:s,valueKey:f,renderLabel:m}),showSearch:C,optionFilterProp:$,allowClear:x}))}}]),a}(P.Component),At=Et,Ut=["type"],N="@@selectData",de="@@selectDataIsStart",ne="@@selectDataTotal";function Nt(r){var t=r.apis,a=t===void 0?[]:t,i=r.defaultProps,e=i===void 0?{}:i;return function(n){var o=n.type,l=M()(n,Ut),s=a.find(function(u){return u.type===o});return s?s.pagination?(0,F.jsx)(Mt,d()(d()(d()({type:o},e),s.defaultProps||{}),{},{loadFunction:s.api},l)):(0,F.jsx)(At,d()(d()(d()({type:o},e),s.defaultProps||{}),{},{loadFunction:s.api},l)):null}}var kt=Nt,Zt=function(t){t?(ie(N,t),ie(de,t),ie(ne,t)):(ie(N),ie(de),ie(ne))},Fr=function(){return null},Rr=function(){return null},Ht=v(59847),Wt=["labelKey","valueKey","type","loadFunction","nodeDisabled","style","value","onChange","queryParams","noCache"],zt=function(r){Pe()(a,r);var t=be()(a);function a(i){var e;return he()(this,a),e=t.call(this,i),p()(g()(e),"reRender",function(n){n.detail.type===e.props.type&&!e.isNoCache()&&(e.setState({loading:!1,dataSource:L(fe,e.props.type)||[]}),ee(Fe,p()({},e.props.type,!1)),e.props.onLoad&&e.props.onLoad(L(fe,e.props.type)||[]))}),p()(g()(e),"isNoCache",function(){var n=e.props,o=n.queryParams,l=o===void 0?{}:o,s=n.noCache;return Object.keys(l).length>0||s}),p()(g()(e),"handleLoadData",function(){e.isNoCache()?e.loadDataWithoutCache():e.loadDataForCache()}),p()(g()(e),"loadDataForCache",function(){var n=e.props,o=n.type,l=n.loadFunction,s=n.valueKey,u=s===void 0?"id":s,f=n.labelKey,m=f===void 0?"name":f,h=n.onLoad;if(L(Fe,o)){e.setState({loading:!0});return}if(L(fe,o)){h&&h(L(fe,o));return}ee(Fe,p()({},o,!0)),e.setState({loading:!0}),l({}).then(function(c){ee(fe,p()({},o,Oe(c,{titleKey:m,valueKey:u}))),h&&h(Oe(c,{titleKey:m,valueKey:u}));var y=new CustomEvent("treeSelectGlobalUpdate",{detail:{type:o}});document.dispatchEvent(y)}).finally(function(){e.setState({loading:!1})})}),p()(g()(e),"loadDataWithoutCache",function(){var n=e.props,o=n.loadFunction,l=n.queryParams,s=n.valueKey,u=s===void 0?"id":s,f=n.labelKey,m=f===void 0?"name":f,h=n.onLoad;e.setState({loading:!0}),o(l).then(function(c){e.setState({dataSource:Oe(c,{titleKey:m,valueKey:u})}),h&&h(Oe(c,{titleKey:m,valueKey:u}))}).finally(function(){e.setState({loading:!1})})}),e.state={loading:!1,dataSource:L(fe,i.type)||[]},e}return me()(a,[{key:"componentDidMount",value:function(){this.handleLoadData(),document.addEventListener("treeSelectGlobalUpdate",this.reRender)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("treeSelectGlobalUpdate",this.reRender)}},{key:"componentDidUpdate",value:function(e){(0,Me.Z)(e.queryParams,this.props.queryParams)||this.handleLoadData()}},{key:"render",value:function(){var e=this.props,n=e.labelKey,o=e.valueKey,l=e.type,s=e.loadFunction,u=e.nodeDisabled,f=e.style,m=f===void 0?{}:f,h=e.value,c=e.onChange,y=e.queryParams,S=e.noCache,R=M()(e,Wt);return(0,F.jsx)(Ht.Z,d()(d()({showSearch:!0,treeNodeFilterProp:"title",allowClear:!0,placeholder:"\u8BF7\u9009\u62E9"},R),{},{style:d()({width:"100%"},m),loading:this.state.loading,value:h,onChange:function(b,C,$){c&&c(b,C,$)},treeData:Ot(this.state.dataSource||[],u)}))}}]),a}(P.Component),Yt=zt,Gt=["type"],fe="@@treeSelectData",Fe="@@treeSelectDataIsStart";function Qt(r){var t=r.apis,a=t===void 0?[]:t,i=r.defaultProps,e=i===void 0?{}:i;return function(n){var o=n.type,l=M()(n,Gt),s=a.find(function(u){return u.type===o});return s?(0,F.jsx)(Yt,d()(d()(d()({type:o},e),s.defaultProps||{}),{},{loadFunction:s.api},l)):null}}var Jt=Qt,Xt=function(t){t?(ie(fe,t),ie(Fe,t)):(ie(fe),ie(Fe))},Tr=function(){return null},$r=function(){return null},qt=v(19632),_t=v.n(qt),er=v(23974),nr=v(73935),tr=["value","onChange","multiple","children","onFinish","errorHandle","responseToFileList","nameKey","urlKey"],rr=["urlKey","nameKey","responseToFileList","errorHandle"];function vn(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=r||[];return t.map(function(a){return a.status||(a.status="done"),a})}function ar(r){var t=r.value,a=r.onChange,i=r.multiple,e=i===void 0?!0:i,n=r.children,o=r.onFinish,l=r.errorHandle,s=r.responseToFileList,u=r.nameKey,f=r.urlKey,m=M()(r,tr),h=(0,P.useContext)(We)||{},c=h.urlKey,y=h.nameKey,S=h.responseToFileList,R=h.errorHandle,T=M()(h,rr),b=u||y||"name",C=f||c||"url",$=t&&t.filter(Boolean).map(function(Q){return d()(d()({},Q),{},{name:Q[b],url:Q[C]})}),x=(0,P.useRef)(null),I=(0,P.useRef)(!0),K=(0,P.useState)(vn($)),B=oe()(K,2),E=B[0],H=B[1],A=(0,P.useState)(!1),z=oe()(A,2),Y=z[0],k=z[1];(0,P.useEffect)(function(){if(I.current){I.current=!1;return}x.current||H(vn($)),x.current=!1},[t]);var G=function(q){k(!0);var le=_t()(q.fileList),re=le.map(function(V){if(V.response){var U=V.response,D=s||S,_=D?D(U):{};return d()(d()({},V),_)}return V});if(q.file.status==="error"){var O=l||R;O&&O(q.file.response||{})}if((0,nr.flushSync)(function(){return H(re)}),re.every(function(V){return V.status!=="uploading"})){var j=re.filter(function(V){return["done","success"].includes(V.status)});a&&(a(j),x.current=!0),o&&o(j),k(!1)}},X=function(){return n&&(typeof n=="function"?n({loading:Y}):(0,P.cloneElement)(n,{loading:Y}))};return(0,F.jsx)(er.Z,d()(d()(d()({multiple:e},T),{},{fileList:E,onChange:G},m),{},{children:X()}))}var or=ar,Ir=function(){return null},ir=function(t){var a=t.proTableSetting,i=t.modalFormSetting,e=t.schemaFormSetting,n=t.formUploadSetting,o=t.children;return(0,F.jsx)(ke.Provider,{value:a,children:(0,F.jsx)(Ze.Provider,{value:i,children:(0,F.jsx)(He.Provider,{value:e,children:(0,F.jsx)(We.Provider,{value:n,children:o})})})})},lr=ir}}]);
