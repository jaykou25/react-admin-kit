---
date: 2025-01-02
sidebar_label: ModalForm - 弹窗表单:1:核心组件:0
---

# ModalForm - 弹窗表单

通过 schema 生成一个 **弹窗** 表单。

这个组件是 [Modal](https://ant-design.antgroup.com/components/modal-cn#api) 和 [SchemaForm](/components/schema-form) 的结合，此可以透传它们两者的 API。

## 基础

### 基本的使用方法

<Previewer src="@@/ModalForm/demos/basic/index.tsx"/>

### 非受控模式 (推荐)

利用 RAK 提供的 [innerRef](/components/modal-form#innerref)，无需额外定义 open 变量就能控制弹窗，用更加简洁。面的用例默认使用该方式。

<Previewer src="@@/ModalForm/demos/innerRef/index.tsx"/>

## 布局

通过 `formProps` 属性传入 [SchemaForm](/components/schema-form#schemaform) 组件的 API, 来改变表单的布局。

### 多列排布

<Previewer src="@@/ModalForm/demos/multipleCol/index.tsx"/>

### 长表单校验时滚动到所在项

<Previewer src="@@/ModalForm/demos/longForm/index.tsx"/>

### 表单类型和表单初始值

innerRef 上的 `openModal` 方法接受两个参数, 第一个是 formType, 第二个是 initialValues.

- formType 有三种类型, `new | edit | read`, 默认值是 `new`, 在 onFinish 和 onOpen 属性里可以根据该值做不同的处理.

- initialValues 是给表单的初始值.

<Previewer src="@@/ModalForm/demos/readonly/index.tsx"/>

### onOpen 请求数据后回显

可利用 formType 只在编辑和查看时才请求

<Previewer src="@@/ModalForm/demos/onOpen/index.tsx"/>

### 表单项显示隐藏

请使用 valueType='dependency'来做显示控制, 原来的 renderFormItem 已经弃用.

<Previewer src="@@/ModalForm/demos/initValue/index.tsx"/>

### onFinish

onFinish 回调有三个参数, 第一个参数是表单里收集到的值 values, 第二个参数是表单类型 formType, 第三个参数是打开弹窗时赋给表单的初始值 formData (这里可以携带一些额外数据比如 id 等).

<Previewer src="@@/ModalForm/demos/onFinish/index.tsx"/>

### ⭐ 数据处理和收集 - 约定式

与 [SchemaForm](/components/schema-form#-数据处理和收集---约定式) 一样, ModalForm 同样支持约定式数据处理.

<Previewer src="@@/ModalForm/demos/convention/index.tsx"/>

### 利用 innerRef 存储额外信息

与 [SchemaForm](/components/schema-form#利用-innerref-存储额外信息) 一样, ModalForm 也能利用 innerRef 存储额外数据.

<Previewer src="@@/ModalForm/demos/innerRefData/index.tsx"/>

### API

### ModalForm

<API filePath='src/ModalForm/index.tsx' name='ModalFormType'></API>

### InnerRef

| 参数      | 说明                                                                                                                        | 类型                                                                  | 默认值 |
| --------- | --------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------- | ------ |
| openModal | 用于打开弹窗; formType 可用于在 onFinish 的时候判断表单类型; `innerRef.current?.openModal('edit', {name: 'jack', age: 18})` | `(formType?: 'new' \| 'edit' \| 'read', initialValues?: any) => void` | -      |
| formType  | 当前的表单类型                                                                                                              | `'new' \| 'edit' \| 'read'`                                           | `new`  |
| data      | 可以存储表单中的额外数据                                                                                                    | `Record<string, any>`                                                 | `{}`   |
| setData   | 存入数据; setData 和 react 的 setState 一样, 只需要传入关心的字段就可以, 不会覆盖其它的字段.                                | `(Record<string, any>) => void`                                       | `--`   |

### 透传给 Modal 的 API 可参考[Antd Modal 文档](https://ant.design/components/modal-cn/#api)
